<!DOCTYPE html>

<html lang="en">
<head>
<meta charset="utf-8"/>
<meta content="width=device-width, initial-scale=1.0" name="viewport"/>
<title>Sommeil | Sleep Monitoring Dashboard</title>
<script src="https://cdn.tailwindcss.com"></script>
<script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
<link href="https://fonts.googleapis.com/css2?family=Orbitron:wght@400;500;700&amp;family=Roboto:wght@300;400;500&amp;display=swap" rel="stylesheet"/>
<style>
        body {
            font-family: 'Roboto', sans-serif;
            background-color: #0a192f;
            color: #e6f1ff;
        }
        .orbitron {
            font-family: 'Orbitron', sans-serif;
        }
        .glass-card {
            background: rgba(15, 23, 42, 0.7);
            backdrop-filter: blur(10px);
            border: 1px solid rgba(255, 255, 255, 0.1);
        }
        .sleep-absent {
            background-color: #1e293b;
        }
        .sleep-light {
            background-color: #0ea5e9;
        }
        .sleep-deep {
            background-color: #6366f1;
        }
        .sleep-rem {
            background-color: #a855f7;
        }
        .glow {
            box-shadow: 0 0 10px rgba(59, 130, 246, 0.5);
        }
        .glow:hover {
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.8);
        }
        .hypnogram-bar {
            height: 20px;
            transition: all 0.3s ease;
        }
        .hypnogram-bar:hover {
            transform: scaleY(1.5);
        }
    </style>
</head>
<body class="min-h-screen">
<!-- Navigation -->
<nav class="bg-slate-900 border-b border-slate-700">
<div class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8">
<div class="flex items-center justify-between h-16">
<div class="flex items-center">
<div class="flex-shrink-0">
<span class="text-2xl font-bold orbitron text-cyan-400">SOMMEIL</span>
</div>
<div class="hidden md:block">
<div class="ml-10 flex items-baseline space-x-4">
<a class="px-3 py-2 rounded-md text-sm font-medium bg-slate-800 text-white" href="#">Dashboard</a>
<a class="px-3 py-2 rounded-md text-sm font-medium text-slate-300 hover:text-white" href="#">History</a>
<a class="px-3 py-2 rounded-md text-sm font-medium text-slate-300 hover:text-white" href="#">Settings</a>
</div>
</div>
</div>
<div class="hidden md:block">
<div class="ml-4 flex items-center md:ml-6">
<span class="text-sm text-slate-300 mr-4">Last sync: <span id="lastSync">Just now</span></span>
<button class="p-1 rounded-full text-slate-400 hover:text-white focus:outline-none">
<svg class="h-6 w-6" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M10.325 4.317c.426-1.756 2.924-1.756 3.35 0a1.724 1.724 0 002.573 1.066c1.543-.94 3.31.826 2.37 2.37a1.724 1.724 0 001.065 2.572c1.756.426 1.756 2.924 0 3.35a1.724 1.724 0 00-1.066 2.573c.94 1.543-.826 3.31-2.37 2.37a1.724 1.724 0 00-2.572 1.065c-.426 1.756-2.924 1.756-3.35 0a1.724 1.724 0 00-2.573-1.066c-1.543.94-3.31-.826-2.37-2.37a1.724 1.724 0 00-1.065-2.572c-1.756-.426-1.756-2.924 0-3.35a1.724 1.724 0 001.066-2.573c-.94-1.543.826-3.31 2.37-2.37.996.608 2.296.07 2.572-1.065z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
<path d="M15 12a3 3 0 11-6 0 3 3 0 016 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</button>
</div>
</div>
</div>
</div>
</nav>
<!-- Main Content -->
<main class="max-w-7xl mx-auto px-4 sm:px-6 lg:px-8 py-8">
<div class="flex justify-between items-center mb-8">
<h1 class="text-3xl font-bold orbitron text-cyan-400">Sleep Dashboard</h1>
<div class="flex space-x-4">
<button class="flex items-center px-4 py-2 bg-slate-800 rounded-lg hover:bg-slate-700 transition" id="refreshBtn">
<svg class="h-5 w-5 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
                    Refresh Data
                </button>
<button class="flex items-center px-4 py-2 bg-indigo-600 rounded-lg hover:bg-indigo-700 transition" id="alarmBtn">
<svg class="h-5 w-5 mr-2" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M12 8v4l3 3m6-3a9 9 0 11-18 0 9 9 0 0118 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
                    Set Alarm
                </button>
</div>
</div>
<!-- Current Night Summary -->
<div class="grid grid-cols-1 md:grid-cols-4 gap-6 mb-8">
<!-- Sleep Score -->
<div class="glass-card rounded-xl p-6 glow">
<div class="flex justify-between items-start">
<div>
<p class="text-slate-400">Sleep Quality</p>
<span class="text-4xl font-bold text-white">{{ sleep_quality }}</span><span class="text-white/40 text-lg">/100</span>

</div>
<div class="w-16 h-16 rounded-full bg-gradient-to-br from-cyan-500 to-blue-600 flex items-center justify-center">
<svg class="h-8 w-8 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M5 3v4M3 5h4M6 17v4m-2-2h4m5-16l2.286 6.857L21 12l-5.714 2.143L13 21l-2.286-6.857L5 12l5.714-2.143L13 3z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</div>
</div>
<div class="mt-4">
<div class="h-2 bg-slate-700 rounded-full overflow-hidden">
<div class="h-full bg-gradient-to-r from-cyan-500 to-blue-600 rounded-full" style="width: 87%"></div>
</div>
<p class="text-sm text-slate-300 mt-2">Excellent sleep with good REM cycles</p>
</div>
</div>
<!-- Heart Rate -->
<div class="glass-card rounded-xl p-6">
<div class="flex justify-between items-start">
<div>
<p class="text-slate-400">Heart Rate</p>
<span class="text-4xl font-bold text-white">{{ heart_rate_avg }}</span><span class="text-white/40 text-lg">bpm</span>

</div>
<div class="w-16 h-16 rounded-full bg-gradient-to-br from-red-500 to-pink-600 flex items-center justify-center">
<svg class="h-8 w-8 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M4.318 6.318a4.5 4.5 0 000 6.364L12 20.364l7.682-7.682a4.5 4.5 0 00-6.364-6.364L12 7.636l-1.318-1.318a4.5 4.5 0 00-6.364 0z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</div>
</div>
<div class="mt-4">
<p class="text-sm text-slate-300">Resting heart rate during sleep</p>
</div>
</div>
<!-- Temperature -->
<div class="glass-card rounded-xl p-6">
<div class="flex justify-between items-start">
<div>
<p class="text-slate-400">Temperature</p>
<span class="text-4xl font-bold text-white">{{ temperature_avg }}</span><span class="text-white/40 text-lg">Â°C</span>
</div>
<div class="w-16 h-16 rounded-full bg-gradient-to-br from-yellow-500 to-orange-600 flex items-center justify-center">
<svg class="h-8 w-8 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</div>
</div>
<div class="mt-4">
<p class="text-sm text-slate-300">Optimal room temperature</p>
</div>
</div>
<!-- Sleep Duration -->
<div class="glass-card rounded-xl p-6">
<div class="flex justify-between items-start">
<div>
<p class="text-slate-400">Sleep Duration</p>
<span class="text-4xl font-bold text-white">{{ sleep_duration }}</span><span class="text-white/40 text-lg">hrs</span>
</div>
<div class="w-16 h-16 rounded-full bg-gradient-to-br from-purple-500 to-indigo-600 flex items-center justify-center">
<svg class="h-8 w-8 text-white" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M20 7l-8-4-8 4m16 0l-8 4m8-4v10l-8 4m0-10L4 7m8 4v10M4 7v10l8 4" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</div>
</div>
<div class="mt-4">
<p class="text-white/40 text-sm mt-2">From {{ start_time }} to {{ end_time }}</p>
</div>
</div>
</div>
<!-- Charts Row -->
<div class="grid grid-cols-1 lg:grid-cols-2 gap-6 mb-8">
<!-- Sleep Phases Chart -->
<div class="glass-card rounded-xl p-6">
<h3 class="text-lg font-medium orbitron mb-4">Sleep Phases</h3>
<div class="h-64">
<canvas id="sleepPhasesChart"></canvas>
</div>
</div>
<!-- Heart Rate Chart -->
<div class="glass-card rounded-xl p-6">
<h3 class="text-lg font-medium orbitron mb-4">Heart Rate &amp; Temperature</h3>
<div class="h-64">
<canvas id="heartRateChart"></canvas>
</div>
</div>
</div>
<!-- Hypnogram -->
<div class="glass-card rounded-xl p-6 mb-8">
<h3 class="text-lg font-medium orbitron mb-4">Hypnogram</h3>
<div class="bg-slate-800 rounded-lg p-4">
<div class="flex mb-2">
<div class="w-24 text-xs text-slate-400">Time</div>
<div class="flex-1 text-xs text-slate-400">Sleep Phase</div>
</div>
<div class="flex items-center mb-1">
<div class="w-24 text-sm">10:00 PM</div>
<div class="flex-1 flex h-6" id="hypnogramContainer"></div>
</div>
<div class="flex justify-between text-xs text-slate-400 px-24">
<span>Start</span>
<span>3 AM</span>
<span>End</span>
</div>
</div>
<div class="flex justify-center mt-4 space-x-4">
<div class="flex items-center">
<div class="w-4 h-4 rounded-full bg-slate-700 mr-2"></div>
<span class="text-xs">Absent</span>
</div>
<div class="flex items-center">
<div class="w-4 h-4 rounded-full bg-blue-500 mr-2"></div>
<span class="text-xs">Light</span>
</div>
<div class="flex items-center">
<div class="w-4 h-4 rounded-full bg-indigo-500 mr-2"></div>
<span class="text-xs">Deep</span>
</div>
<div class="flex items-center">
<div class="w-4 h-4 rounded-full bg-purple-500 mr-2"></div>
<span class="text-xs">REM</span>
</div>
</div>
</div>
<!-- Recent Nights -->
<div class="glass-card rounded-xl p-6 mb-8">
<h3 class="text-lg font-medium orbitron mb-4">Recent Nights</h3>
<div class="grid grid-cols-2 md:grid-cols-3 lg:grid-cols-7 gap-4">
<div class="bg-slate-800 rounded-lg p-4 text-center cursor-pointer hover:bg-slate-700 transition">
<div class="text-sm text-slate-300 mb-1">Mon</div>
<div class="text-lg font-bold orbitron text-white mb-2">12</div>
<div class="h-2 bg-slate-700 rounded-full overflow-hidden mb-1">
<div class="h-full bg-gradient-to-r from-cyan-500 to-blue-600 rounded-full" style="width: 72%"></div>
</div>
<div class="text-xs text-slate-400">{{ moyenne_bpm }} bpm</div>
</div>
<div class="bg-slate-800 rounded-lg p-4 text-center cursor-pointer hover:bg-slate-700 transition">
<div class="text-sm text-slate-300 mb-1">Tue</div>
<div class="text-lg font-bold orbitron text-white mb-2">13</div>
<div class="h-2 bg-slate-700 rounded-full overflow-hidden mb-1">
<div class="h-full bg-gradient-to-r from-cyan-500 to-blue-600 rounded-full" style="width: 65%"></div>
</div>
<div class="text-xs text-slate-400">{{ moyenne_temp }}Â°C</div>
</div>
<div class="bg-slate-800 rounded-lg p-4 text-center cursor-pointer hover:bg-slate-700 transition">
<div class="text-sm text-slate-300 mb-1">Wed</div>
<div class="text-lg font-bold orbitron text-white mb-2">14</div>
<div class="h-2 bg-slate-700 rounded-full overflow-hidden mb-1">
<div class="h-full bg-gradient-to-r from-cyan-500 to-blue-600 rounded-full" style="width: 81%"></div>
</div>
<div class="text-xs text-slate-400">{{ moyenne_hum }}%</div>
</div>
<div class="bg-slate-800 rounded-lg p-4 text-center cursor-pointer hover:bg-slate-700 transition">
<div class="text-sm text-slate-300 mb-1">Thu</div>
<div class="text-lg font-bold orbitron text-white mb-2">15</div>
<div class="h-2 bg-slate-700 rounded-full overflow-hidden mb-1">
<div class="h-full bg-gradient-to-r from-cyan-500 to-blue-600 rounded-full" style="width: 78%"></div>
</div>
<div class="text-xs text-slate-400">{{ moyenne_bpm }} bpm</div>
</div>
<div class="bg-slate-800 rounded-lg p-4 text-center cursor-pointer hover:bg-slate-700 transition">
<div class="text-sm text-slate-300 mb-1">Fri</div>
<div class="text-lg font-bold orbitron text-white mb-2">16</div>
<div class="h-2 bg-slate-700 rounded-full overflow-hidden mb-1">
<div class="h-full bg-gradient-to-r from-cyan-500 to-blue-600 rounded-full" style="width: 68%"></div>
</div>
<div class="text-xs text-slate-400">{{ dynamic_value }}</div>
</div>
<div class="bg-slate-800 rounded-lg p-4 text-center cursor-pointer hover:bg-slate-700 transition">
<div class="text-sm text-slate-300 mb-1">Sat</div>
<div class="text-lg font-bold orbitron text-white mb-2">17</div>
<div class="h-2 bg-slate-700 rounded-full overflow-hidden mb-1">
<div class="h-full bg-gradient-to-r from-cyan-500 to-blue-600 rounded-full" style="width: 85%"></div>
</div>
<div class="text-xs text-slate-400">{{ dynamic_value }}</div>
</div>
<div class="bg-blue-600 rounded-lg p-4 text-center cursor-pointer glow">
<div class="text-sm text-blue-100 mb-1">Sun</div>
<div class="text-lg font-bold orbitron text-white mb-2">18</div>
<div class="h-2 bg-blue-400 rounded-full overflow-hidden mb-1">
<div class="h-full bg-white rounded-full" style="width: 87%"></div>
</div>
<div class="text-xs text-blue-100">{{ dynamic_value }}</div>
</div>
</div>
</div>
<!-- Sleep Advice -->
<div class="glass-card rounded-xl p-6">
<h3 class="text-lg font-medium orbitron mb-4">Personalized Sleep Advice</h3>
<div class="grid grid-cols-1 md:grid-cols-3 gap-4">
<div class="bg-gradient-to-br from-slate-800 to-slate-900 rounded-lg p-4 border border-slate-700">
<div class="flex items-center mb-3">
<div class="w-10 h-10 rounded-full bg-blue-900 flex items-center justify-center mr-3">
<svg class="h-5 w-5 text-blue-400" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M13 10V3L4 14h7v7l9-11h-7z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</div>
<h4 class="font-medium">Consistent Bedtime</h4>
</div>
<p class="text-sm text-slate-300">Your bedtime varies by utes. Try to go to bed within utes of the same time each night.{{ dynamic_value }}</p>
</div>
<div class="bg-gradient-to-br from-slate-800 to-slate-900 rounded-lg p-4 border border-slate-700">
<div class="flex items-center mb-3">
<div class="w-10 h-10 rounded-full bg-purple-900 flex items-center justify-center mr-3">
<svg class="h-5 w-5 text-purple-400" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M20.354 15.354A9 9 0 018.646 3.646 9.003 9.003 0 0012 21a9.003 9.003 0 008.354-5.646z" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</div>
<h4 class="font-medium">Wind Down Routine</h4>
</div>
<p class="text-sm text-slate-300">Consider a 30-minute pre-sleep routine to help transition from wakefulness to sleep.</p>
</div>
<div class="bg-gradient-to-br from-slate-800 to-slate-900 rounded-lg p-4 border border-slate-700">
<div class="flex items-center mb-3">
<div class="w-10 h-10 rounded-full bg-cyan-900 flex items-center justify-center mr-3">
<svg class="h-5 w-5 text-cyan-400" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M12 6V4m0 2a2 2 0 100 4m0-4a2 2 0 110 4m-6 8a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4m6 6v10m6-2a2 2 0 100-4m0 4a2 2 0 110-4m0 4v2m0-6V4" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</div>
<h4 class="font-medium">Room Environment</h4>
</div>
<p class="text-sm text-slate-300">Your room temperature is optimal. Keep humidity between 40- for best sleep quality.{{ dynamic_value }}</p>
</div>
</div>
</div>
</main>
<!-- Alarm Modal -->
<div class="fixed inset-0 bg-black bg-opacity-50 flex items-center justify-center z-50 hidden" id="alarmModal">
<div class="bg-slate-800 rounded-xl p-6 w-full max-w-md">
<div class="flex justify-between items-center mb-4">
<h3 class="text-xl font-medium orbitron">Set Wake-up Alarm</h3>
<button class="text-slate-400 hover:text-white" id="closeAlarmModal">
<svg class="h-6 w-6" fill="none" stroke="currentColor" viewbox="0 0 24 24" xmlns="http://www.w3.org/2000/svg">
<path d="M6 18L18 6M6 6l12 12" stroke-linecap="round" stroke-linejoin="round" stroke-width="2"></path>
</svg>
</button>
</div>
<form id="alarmForm">
<div class="mb-4">
<label class="block text-slate-300 text-sm mb-2" for="alarmTime">Alarm Time</label>
<div class="flex items-center">
<select class="bg-slate-700 text-white rounded-l-lg px-4 py-2 w-20 appearance-none focus:outline-none focus:ring-2 focus:ring-blue-500" id="alarmHour">
<option value="06">06</option>
<option selected="" value="07">07</option>
<option value="08">08</option>
<option value="09">09</option>
<option value="10">10</option>
</select>
<span class="bg-slate-700 px-2 py-2 text-white">:</span>
<select class="bg-slate-700 text-white rounded-r-lg px-4 py-2 w-20 appearance-none focus:outline-none focus:ring-2 focus:ring-blue-500" id="alarmMinute">
<option value="00">00</option>
<option value="15">15</option>
<option selected="" value="30">30</option>
<option value="45">45</option>
</select>
</div>
</div>
<div class="mb-4">
<label class="flex items-center">
<input checked="" class="form-checkbox bg-slate-700 text-blue-500 rounded focus:ring-blue-500" type="checkbox"/>
<span class="ml-2 text-slate-300">Smart Wake-up</span>
</label>
<p class="text-xs text-slate-400 mt-1">Wake up during light sleep phase within utes of alarm{{ dynamic_value }}</p>
</div>
<div class="flex justify-end space-x-3">
<button class="px-4 py-2 bg-slate-700 rounded-lg hover:bg-slate-600 transition" id="cancelAlarm" type="button">Cancel</button>
<button class="px-4 py-2 bg-blue-600 rounded-lg hover:bg-blue-700 transition" type="submit">Set Alarm</button>
</div>
</form>
</div>
</div>
<script>
        // Initialize charts
        document.addEventListener('DOMContentLoaded', function() {
            // Sleep Phases Chart
            const sleepPhasesCtx = document.getElementById('sleepPhasesChart').getContext('2d');
            const sleepPhasesChart = new Chart(sleepPhasesCtx, {
                type: 'doughnut',
                data: {
                    labels: {{ heures|safe }},
                    datasets: [{
                        data: {{ bpm|safe }},
                        backgroundColor: [
                            '#6366f1',
                            '#0ea5e9',
                            '#a855f7',
                            '#1e293b'
                        ],
                        borderWidth: 0
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    cutout: '',
                    plugins: {
                        legend: {
                            position: 'right',
                            labels: {
                                color: '#e2e8f0',
                                font: {
                                    family: 'Roboto'
                                },
                                padding: 20
                            }
                        }
                    }
                }
            });

            // Heart Rate Chart
            const heartRateCtx = document.getElementById('heartRateChart').getContext('2d');
            const heartRateChart = new Chart(heartRateCtx, {
                type: 'line',
                data: {
                    labels: {{ heures|safe }},
                    datasets: [
                        {
                            label: 'Heart Rate (bpm)',
                            data: {{ temp|safe }},
                            borderColor: '#ec4899',
                            backgroundColor: 'rgba(236, 72, 153, 0.1)',
                            tension: 0.4,
                            fill: true,
                            yAxisID: 'y'
                        },
                        {
                            label: 'Temperature (Â°C)',
                            data: [22.5, 22.3, 22.1, 21.9, 21.8, 21.7, 21.8, 22.0, 22.3],
                            borderColor: '#f59e0b',
                            backgroundColor: 'rgba(245, 158, 11, 0.1)',
                            tension: 0.4,
                            fill: true,
                            yAxisID: 'y1'
                        }
                    ]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: false,
                    interaction: {
                        mode: 'index',
                        intersect: false,
                    },
                    scales: {
                        x: {
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            },
                            ticks: {
                                color: '#94a3b8'
                            }
                        },
                        y: {
                            type: 'linear',
                            display: true,
                            position: 'left',
                            grid: {
                                color: 'rgba(255, 255, 255, 0.05)'
                            },
                            ticks: {
                                color: '#94a3b8'
                            }
                        },
                        y1: {
                            type: 'linear',
                            display: true,
                            position: 'right',
                            grid: {
                                drawOnChartArea: false,
                                color: 'rgba(255, 255, 255, 0.05)'
                            },
                            ticks: {
                                color: '#94a3b8'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            labels: {
                                color: '#e2e8f0',
                                font: {
                                    family: 'Roboto'
                                }
                            }
                        }
                    }
                }
            });

            // Generate hypnogram
            const hypnogramContainer = document.getElementById('hypnogramContainer');
            const phases = ['sleep-absent', 'sleep-light', 'sleep-deep', 'sleep-rem'];
            const phaseNames = ['Absent', 'Light', 'Deep', 'REM'];
            
            for (let i = 0; i < 60; i++) {
                const randomPhase = Math.floor(Math.random() * 4);
                const bar = document.createElement('div');
                bar.className = `hypnogram-bar ${phases[randomPhase]} flex-1 mr-px rounded-sm`;
                bar.title = `${phaseNames[randomPhase]} sleep`;
                hypnogramContainer.appendChild(bar);
            }

            // Alarm modal functionality
            const alarmModal = document.getElementById('alarmModal');
            const alarmBtn = document.getElementById('alarmBtn');
            const closeAlarmModal = document.getElementById('closeAlarmModal');
            const cancelAlarm = document.getElementById('cancelAlarm');
            const alarmForm = document.getElementById('alarmForm');

            alarmBtn.addEventListener('click', () => {
                alarmModal.classList.remove('hidden');
            });

            closeAlarmModal.addEventListener('click', () => {
                alarmModal.classList.add('hidden');
            });

            cancelAlarm.addEventListener('click', () => {
                alarmModal.classList.add('hidden');
            });

            alarmForm.addEventListener('submit', (e) => {
                e.preventDefault();
                const hour = document.getElementById('alarmHour').value;
                const minute = document.getElementById('alarmMinute').value;
                
                // Here you would typically send this data to your Flask backend
                console.log(`Setting alarm for ${hour}:${minute}`);
                
                // Show confirmation
                alert(`Alarm set for ${hour}:${minute}`);
                alarmModal.classList.add('hidden');
            });

            // Refresh button functionality
            const refreshBtn = document.getElementById('refreshBtn');
            const lastSync = document.getElementById('lastSync');
            
            refreshBtn.addEventListener('click', () => {
                // Simulate data refresh
                refreshBtn.innerHTML = `
                    <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2 animate-spin" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                        <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                    </svg>
                    Refreshing...
                `;
                
                setTimeout(() => {
                    const now = new Date();
                    lastSync.textContent = now.toLocaleTimeString();
                    refreshBtn.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M4 4v5h.582m15.356 2A8.001 8.001 0 004.582 9m0 0H9m11 11v-5h-.581m0 0a8.003 8.003 0 01-15.357-2m15.357 2H15" />
                        </svg>
                        Refresh Data
                    `;
                    
                    // Show toast notification
                    const toast = document.createElement('div');
                    toast.className = 'fixed bottom-4 right-4 bg-green-600 text-white px-4 py-2 rounded-lg shadow-lg flex items-center';
                    toast.innerHTML = `
                        <svg xmlns="http://www.w3.org/2000/svg" class="h-5 w-5 mr-2" fill="none" viewBox="0 0 24 24" stroke="currentColor">
                            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M5 13l4 4L19 7" />
                        </svg>
                        Data refreshed successfully
                    `;
                    document.body.appendChild(toast);
                    
                    setTimeout(() => {
                        toast.remove();
                    }, 3000);
                }, 1500);
            });
        });
    {{ dynamic_value }}</script>
</body>
</html>